<!DOCTYPE html>
<!-- saved from url=(0096)https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/ -->
<html class=" js no-flexbox history rgba hsla multiplebgs borderradius boxshadow textshadow opacity cssgradients csstransitions fontface generatedcontent localstorage sessionstorage no-applicationcache" lang="en" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Getting Started with Binomial Generalized Linear Mixed Models | University of Virginia Library Research Data Services + Sciences</title>
  <meta name="description" content="Collections, services, branches, and contact information.">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="shortcut icon" href="https://data.library.virginia.edu/wp-content/themes/libweb-base/img/favicon.ico">
  <link rel="stylesheet" href="./Binomial Generalized Linear Mixed Models_files/1140.css">
	<link rel="stylesheet" href="./Binomial Generalized Linear Mixed Models_files/style.css">
	<!--[if lt IE 8]><link rel="stylesheet" href="/wp-content/themes/libweb-base/css/1140/ie.css"><![endif]-->
  <link rel="stylesheet" href="./Binomial Generalized Linear Mixed Models_files/bootstrap-custom.min.css">
  <link href="./Binomial Generalized Linear Mixed Models_files/font-awesome.min.css" rel="stylesheet">
  <link rel="alternate" type="application/rss+xml" title="Research Data Services + Sciences Feed" href="https://data.library.virginia.edu/feed/">
  <link rel="dns-prefetch" href="https://s.w.org/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Binomial Generalized Linear Mixed Models_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" href="./Binomial Generalized Linear Mixed Models_files/style.min.css">
<link rel="stylesheet" href="./Binomial Generalized Linear Mixed Models_files/announcer-styles.css">
<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/jquery-1.7.1.min.js.download"></script>
<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/announcer-js.js.download"></script>
<link rel="https://api.w.org/" href="https://data.library.virginia.edu/wp-json/">
<link rel="alternate" type="application/json+oembed" href="https://data.library.virginia.edu/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdata.library.virginia.edu%2Fgetting-started-with-binomial-generalized-linear-mixed-models%2F">
<link rel="alternate" type="text/xml+oembed" href="https://data.library.virginia.edu/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdata.library.virginia.edu%2Fgetting-started-with-binomial-generalized-linear-mixed-models%2F&amp;format=xml">
	<link rel="canonical" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/">
    <link href="./Binomial Generalized Linear Mixed Models_files/include.css" rel="stylesheet" type="text/css">
  <link href="./Binomial Generalized Linear Mixed Models_files/css" rel="stylesheet" type="text/css">
  <script src="./Binomial Generalized Linear Mixed Models_files/libweb-base.js.download"></script>
  <script src="./Binomial Generalized Linear Mixed Models_files/modernizr-2.5.3-custom.min.js.download"></script>
  <script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/MathJax.js.download">
  </script>

  <script src="./Binomial Generalized Linear Mixed Models_files/webcomponents-loader.js.download"></script>
  <link rel="import" href="https://www.library.virginia.edu/bower_components/uvalib-search-box/uvalib-search-box.html">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.skipTo{padding:.5em;position:absolute;background:transparent;color:#000;-webkit-transition:top .5s ease-out,background .5s linear;-moz-transition:top .5s ease-out,background .5s linear;-o-transition:top .5s ease-out,background .5s linear;transition:top .5s ease-out,background .5s linear}.skipTo:focus{position:absolute;top:0;left:0;background:#ccc;z-index:1000;text-decoration:underline;-webkit-transition:top .1s ease-in,background .3s linear;-moz-transition:top .1s ease-in,background .3s linear;-o-transition:top .1s ease-in,background .3s linear;transition:top .1s ease-in,background .3s linear}.onFocus{top:-5em;left:0}.onLoad{top:0;left:0;background:#ccc}.dropup,.dropMenu{position:relative}.dropMenu-toggle{*margin-bottom:-3px}.dropMenu-toggle:active,.open .dropMenu-toggle{outline:0}#skipToMenu .caret{display:inline-block;width:0;height:0;vertical-align:top;border-top:4px solid #000;border-right:4px solid transparent;border-left:4px solid transparent;content:'';pointer-events:none}#skipToMenu .dropMenu .caret{margin-top:8px;margin-left:2px}.dropMenu-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.2);*border-right-width:2px;*border-bottom-width:2px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,0.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,0.2);box-shadow:0 5px 10px rgba(0,0,0,0.2);-webkit-background-clip:padding-box;-moz-background-clip:padding;background-clip:padding-box}.dropMenu-menu.pull-right{right:0;left:auto}.dropMenu-menu .divider{*width:100%;height:1px;margin:9px 1px;*margin:-5px 0 5px;overflow:hidden;background-color:#e5e5e5;border-bottom:1px solid #fff}.dropMenu-menu>li>a{display:block;padding:3px 20px;clear:both;font-weight:normal;line-height:20px;color:#333;white-space:nowrap;text-decoration:none}.dropMenu-menu>li>a.po-h1{font-size:110%}.dropMenu-menu>li>a.po-h2{padding-left:28px}.dropMenu-menu>li>a.po-h3{padding-left:36px}.dropMenu-menu>li>a.po-h4{padding-left:44px}.dropMenu-menu>li>a.po-h5{padding-left:52px}.dropMenu-menu>li>a.po-6{padding-left:60px}.dropMenu-menu>li[role=separator]{padding-left:20px;margin-top:9px;font-weight:bold;border-bottom:thin solid black}.dropMenu-menu>li>a:hover,.dropMenu-menu>li>a:focus,.dropMenu-submenu:hover>a,.dropMenu-submenu:focus>a{text-decoration:none;color:#fff;background-color:#0081c2;background-image:-moz-linear-gradient(top,#08c,#0077b3);background-image:-webkit-gradient(linear,0 0,0 100%,from(#08c),to(#0077b3));background-image:-webkit-linear-gradient(top,#08c,#0077b3);background-image:-o-linear-gradient(top,#08c,#0077b3);background-image:linear-gradient(to bottom,#08c,#0077b3);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0088cc',endColorstr='#ff0077b3',GradientType=0)}.dropMenu-menu>.active>a,.dropMenu-menu>.active>a:hover,.dropMenu-menu>.active>a:focus{color:#fff;text-decoration:none;outline:0;background-color:#0081c2;background-image:-moz-linear-gradient(top,#08c,#0077b3);background-image:-webkit-gradient(linear,0 0,0 100%,from(#08c),to(#0077b3));background-image:-webkit-linear-gradient(top,#08c,#0077b3);background-image:-o-linear-gradient(top,#08c,#0077b3);background-image:linear-gradient(to bottom,#08c,#0077b3);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0088cc',endColorstr='#ff0077b3',GradientType=0)}.dropMenu-menu>.disabled>a,.dropMenu-menu>.disabled>a:hover,.dropMenu-menu>.disabled>a:focus{color:#999}.dropMenu-menu>.disabled>a:hover,.dropMenu-menu>.disabled>a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:default}.open{*z-index:1000}.open>.dropMenu-menu{display:block}.pull-right>.dropMenu-menu{right:0;left:auto}#skipToMenu .dropup .caret,#skipToMenu .navbar-fixed-bottom .dropMenu .caret{border-top:0;border-bottom:4px solid #000;content:''}#skipToMenu .dropup .dropMenu-menu,#skipToMenu .navbar-fixed-bottom .dropMenu .dropMenu-menu{top:auto;bottom:100%;margin-bottom:1px}.dropMenu-submenu{position:relative}.dropMenu-submenu>.dropMenu-menu{top:0;left:100%;margin-top:-6px;margin-left:-1px;-webkit-border-radius:0 6px 6px 6px;-moz-border-radius:0 6px 6px 6px;border-radius:0 6px 6px 6px}.dropMenu-submenu:hover>.dropMenu-menu{display:block}.dropup .dropMenu-submenu>.dropMenu-menu{top:auto;bottom:0;margin-top:0;margin-bottom:-2px;-webkit-border-radius:5px 5px 5px 0;-moz-border-radius:5px 5px 5px 0;border-radius:5px 5px 5px 0}.dropMenu-submenu>a:after{display:block;content:' ';float:right;width:0;height:0;border-color:transparent;border-style:solid;border-width:5px 0 5px 5px;border-left-color:#ccc;margin-top:5px;margin-right:-10px}.dropMenu-submenu:hover>a:after{border-left-color:#fff}.dropMenu-submenu.pull-left{float:none}.dropMenu-submenu.pull-left>.dropMenu-menu{left:-100%;margin-left:10px;-webkit-border-radius:6px 0 6px 6px;-moz-border-radius:6px 0 6px 6px;border-radius:6px 0 6px 6px}.dropMenu .dropMenu-menu .nav-header{padding-left:20px;padding-right:20px}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class="post-template-default single single-post postid-8952 single-format-standard statlab-articles no-bg"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="skipToMenu" role="complementary" title="Skip To Keyboard Navigation" class="dropMenu"><a accesskey="0" tabindex="0" data-wrap="true" class="dropMenu-toggle skipTo onFocus " id="drop4" role="button" aria-haspopup="true" aria-expanded="false" data-toggle="dropMenu" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#" data-target="menu1">Skip To...<span class="caret"></span></a><ul id="menu1" class="dropMenu-menu" role="menu" aria-label="Skip To and Page Outline" style="top:3%; text-align:left"><li role="separator" style="list-style:none outside none">Skip To</li><li role="presentation" style="list-style:none outside none"><a tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#main">Main Content</a></li><li role="presentation" style="list-style:none outside none"><a tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#sidebar">Complementary</a></li><li role="presentation" style="list-style:none outside none"><a tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#main-nav">Nav</a></li><li role="presentation" style="list-style:none outside none"><a tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#nav-utility">Nav</a></li><li role="presentation" style="list-style:none outside none"><a tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#content">id: Getting Started with Binomial ...</a></li><li role="separator" style="list-style:none outside none">Page Outline</li><li role="presentation" style="list-style:none outside none"><a class="po-h1" tabindex="-1" role="menuitem" href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#getting_started_with_binomial_generalized_linear_mixed_models_2">h1: Getting Started with Binomi...</a></li></ul></div><div id="MathJax_Message" style="display: none;"></div>
<noscript>
    <div  style="background-color: #ffffff; text: #000; padding: 5px;">
        JavaScript must be enabled in order for you to use our website. However, it seems JavaScript is either disabled or not supported by your browser.
    </div>
</noscript>

    <div id="wrap" role="document">
    <div id="jump-menu" class="visuallyhidden">
      Jump to:
      <ul>
        <li><a href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#content">Main content</a></li>
        <li><a href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#main-nav">Main navigation</a></li>
        <li id="searchlink" style="display:none"><a href="https://data.library.virginia.edu/getting-started-with-binomial-generalized-linear-mixed-models/#search">Search</a></li>
        <li><a href="https://www.library.virginia.edu/services/accessibility-services/">Accessibility Services</a></li>
      </ul>
      <script>
        $(function(){ if( $('#search, [name="search"]').length > 0){ $('#searchlink').show(); }  });
      </script>
    </div>
    <div class="container top-container">
      <div class="row top-row">
        <nav class="sixcol" id="main-nav" tabindex="-1">
          <h3 class="visuallyhidden">U.Va. Links</h3>
          <ul>
            <li><a class="return-home" href="https://data.library.virginia.edu/">Research Data Services + Sciences Home</a></li>
            <li><a href="http://www.virginia.edu/">U.Va. Home</a></li>
            <li><a href="https://library.virginia.edu/">U.Va. Library</a></li>
          </ul>
        </nav>
        <div class="sixcol last">
                  </div>
      </div>
    </div>
  <div class="container header-container"><div class="row header-row clearfix">
    <header id="top-banner" class="twelvecol" role="banner">
            <div class="container">
        <h1 class="ninecol" id="main-title">
          <a href="https://data.library.virginia.edu/">
            <span class="donor-title">University of Virginia Library</span>
            <span class="library-title">Research Data Services + Sciences</span>
        </a></h1>
        <a class="threecol last" id="logo" href="https://library.virginia.edu/" aria-label="University of Virginia Library">
          <img src="./Binomial Generalized Linear Mixed Models_files/liblogo.png" width="198" height="90" alt="University of Virginia Library">
        </a>
      </div>
    </header>
  </div></div><!-- /.row /.container -->
<div class="container content-container"><div class="row content-row clearfix">
      <div id="content" class="row">
          <div id="main" class="ninecol" role="main" tabindex="-1">
        <div class="container">
                          <article class="post-8952 post type-post status-publish format-standard hentry category-statlab-articles tag-binomial-glmm tag-clay-ford tag-logistic-regression tag-mixed-effect-models tag-r tag-statistical-methods" id="post-8952">
          <header>
        <h1 class="entry-title" tabindex="-1" id="getting_started_with_binomial_generalized_linear_mixed_models_2">Getting Started with Binomial Generalized Linear Mixed Models</h1>
        <time class="updated" datetime="2021-03-19T17:28:39+00:00" pubdate="">Posted on Friday, March 19th, 2021 at 5:28 pm.</time><p class="byline author vcard">Written by <a href="https://data.library.virginia.edu/author/jcf2d/" rel="author" class="fn">jcf2d</a></p>      </header>
      <div class="entry-content">
        <p>Binomial Generalized Linear Mixed Models, or binomial GLMMs, are useful for modeling binary outcomes for repeated or clustered measures. For example, let’s say we design a study that tracks what college students eat over the course of 2 weeks, and we’re interested in whether or not they eat vegetables each day. For each student we’ll have 14 binary events: eat vegetables or not. Using a binomial GLMM we could model the probability of eating vegetables daily given various predictors such as sex of the student, race of the student, and/or some “treatment” we applied to a subset of the students, such as a nutrition class. Since each student is observed over the course of multiple days, we have repeated measures and thus the need for a mixed-effect model.</p>
<p>Before we show how to implement and interpret a binomial GLMM, we’ll first simulate some data that is appropriate for a binomial GLMM. If we know how to simulate data for a given model, then we have a better understanding of the model’s assumptions and coefficients. We’ll use R to simulate the data and perform the modeling.</p>
<p>To begin we simulate data for four predictor variables:</p>
<ul>
<li>id (indentifying number of subject)</li>
<li>day (the day of observation)</li>
<li>trt (treatment status: control or treat)</li>
<li>sex (male or female)</li>
</ul>
<p>We set “n” to 250 which means we’ll have 250 subjects in our data. Then we use <code>seq(n)</code> to generate a vector of integers ranging 1 to 250 and assign to “id”. These will be our subject ids. We assign to “day” the integers 1 – 14 and then use <code>expand.grid</code> to create all combinations of “id” and “day” and assign to “d”, which is a data frame. To simulate the “trt” and “sex” variables we simply sample 250 times from the possible values with replacement. The <code>set.seed(1)</code> function ensures we always simulate the same values, which you’ll need to run if you want to replicate the results of this article. After we simulate the “trt” and “sex” values, we need to repeat them 14 times each for each subject id. We do that by using subsetting brackets and assigning the result to the data frame “d”. Finally we sort the data by “id” and “day”, reset the row numbers, and look at the first 15 records.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>n &lt;- 250
id &lt;- seq(n)
day &lt;- 1:14
d &lt;- expand.grid(id = id, day = day)
set.seed(1)
trt &lt;- sample(c("control", "treat"), size = n, replace = TRUE)
sex &lt;- sample(c("female", "male"), size = n, replace = TRUE)
d$trt &lt;- trt[d$id]
d$sex &lt;- sex[d$id]
d &lt;- d[order(d$id, d$day),]
rownames(d) &lt;- NULL
head(d, n = 15)

##    id day     trt    sex
## 1   1   1 control female
## 2   1   2 control female
## 3   1   3 control female
## 4   1   4 control female
## 5   1   5 control female
## 6   1   6 control female
## 7   1   7 control female
## 8   1   8 control female
## 9   1   9 control female
## 10  1  10 control female
## 11  1  11 control female
## 12  1  12 control female
## 13  1  13 control female
## 14  1  14 control female
## 15  2   1   treat   male

</pre>
</div>
<p>We see that subject 1 is a female in the control group, with 14 observations over 14 days.</p>
<p>Now we’re ready to use this data to simulate zeroes and ones for the event of eating vegetables or not, where a 0 means “did not eat vegetables” and a 1 means “ate vegetables”. We want to simulate the zeroes and ones using probabilities. We’ll use the <code>rbinom</code> function to do this, which generates zeroes or ones from a binomial distribution. For example to generate 5 flips of a single coin with a probability of success (say, heads) of 0.5, we can do the following:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>rbinom(n = 5, size = 1, prob = 0.5)
## [1] 1 1 1 1 0

</pre>
</div>
<p>But we don’t have a constant probability. We’ll have a probability that changes based on the sex of the subject and whether they were in the treatment group or not. Since we’re simulating the data, we get to pick the probabilities.</p>
<ul>
<li>female, control: p = 0.40</li>
<li>female, treated: p = 0.85</li>
<li>male, control: p = 0.30</li>
<li>male, treated: p = 0.50</li>
</ul>
<p>These are what we might call <em>fixed effects</em>. We’re saying the effects of treatment and sex are fixed, no matter who you are, where you’re from, how old you are, etc. This may not be a plausible assumption in real life, but that’s what we’re assuming when we simulate this particular data set. Also notice these effects <em>interact</em>. The effect of treatment increases the female probability by 0.45, but only increases the male probability by 0.20. The effect of treatment depends on sex, which implies they interact.</p>
<p>But recall we’re observing the same person 14 days in a row. This means we won’t have independent observations. Those 14 observations on the same person may be correlated in some way. The simplest way to induce this correlation is to add a <em>random effect</em> for each person. For example, maybe a male student grew up in a family that had a garden in the backyard and was raised eating homegrown vegetables. His random effect might be an additional 0.10 probability. So if he was in the control group, his probability might be 0.30 (fixed) + 0.10 (random) = 0.40. So now we have a <em>mix</em> of fixed effects and random effects.</p>
<p>Let’s add our fixed effect probabilities to the data frame. We use the <code>interaction</code> function to create a 4-level factor called “trtsex” that indicates whether a subject is male/female and treated/control. Then we create a vector of probabilities and name the vector using the level names of the “trtsex” variable. This becomes a lookup table which we can use with “trtsex” to quickly determine a subject’s fixed effect probability.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>d$trtsex &lt;- interaction(d$trt, d$sex)
probs &lt;- c(0.40, 0.85, 0.30, 0.50)
names(probs) &lt;- levels(d$trtsex)
d$p &lt;- probs[d$trtsex]

</pre>
</div>
<p>Now let’s add random effect probabilities. We’ll do this by drawing <code>n</code> random samples from a Normal distribution with a mean 0 and a standard deviation of 0.03. This will create random amounts of probability that we add or subtract from a subject’s fixed effect probability. Again we use “r_probs” as a lookup table and use subsetting brackets to pick the random probability according to subject id. Notice it gets repeated 14 times for each subject.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>set.seed(3)
r_probs &lt;- rnorm(n = n, mean = 0, sd = 0.03)
d$random_p &lt;- r_probs[d$id]
d$p &lt;- d$p + d$random_p

</pre>
</div>
<p>And now we can use the probabilities to generate zeroes and ones with the <code>binom</code> function.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>d$y &lt;- rbinom(n = nrow(d), size = 1, prob = d$p)

</pre>
</div>
<p>With that our data is simulated. Let’s inspect the first few records.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>head(d[c("id", "day", "trt", "sex", "p", "y")])

##   id day     trt    sex        p y
## 1  1   1 control female 0.371142 0
## 2  1   2 control female 0.371142 0
## 3  1   3 control female 0.371142 1
## 4  1   4 control female 0.371142 0
## 5  1   5 control female 0.371142 0
## 6  1   6 control female 0.371142 0

</pre>
</div>
<p>Subject 1 (female/control) reported eating vegetables 1 time in the first 6 days. And we see her probability is 0.37. Her random effect is about 0.37 – 0.40 = -0.03.</p>
<p>Let’s look at subject 5.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>head(d[d$id == 5, c("id", "day", "trt", "sex", "p", "y")])

##    id day   trt    sex         p y
## 57  5   1 treat female 0.8558735 1
## 58  5   2 treat female 0.8558735 1
## 59  5   3 treat female 0.8558735 1
## 60  5   4 treat female 0.8558735 1
## 61  5   5 treat female 0.8558735 1
## 62  5   6 treat female 0.8558735 1

</pre>
</div>
<p>Subject 5 (female/treat) reported eating vegetables everyday in the first 6 days. And we see her probability is about 0.86. Her random effect is around 0.86 – 0.85 = 0.01.</p>
<hr>
<p><strong>Full Disclosure</strong>: The way we just simulated our data is not technically correct! We could have easily generated a random effect that pushed a subject’s probability beyond 1 or below 0! However we thought this approach was a good place to start because it allows us to think in terms of probabilities. The correct way is demonstrated later in the article and, as we’ll see, involves log-odds which are much less intuitive.</p>
<hr>
<p>Now let’s work backwards and pretend we don’t know the probabilities we defined above. We just have “id”, “day”, “trt”, “sex” and “y”. We want to fit a binomial GLMM model to see how “sex” and “trt” affect the probability of eating vegetables. In real life we won’t know if or how they affect the probability. We may have a hunch, but all we can really do is propose a model and see how well it fits the data. To do this we’ll use the <code>glmer</code> function in the lme4 package.</p>
<p>Let’s make life easy for us and propose the “correct” model, which we know since we simulated the data. We model y as a function sex, trt, and their interaction: <code>y ~ trt * sex</code>. We also include a random effect for each subject with <code>+ (1|id)</code>, which is also known as a <em>random intercept</em> since the model estimates a different intercept for each subject. We can read <code>1|id</code> as “the intercept is conditional on subject id.” (In R model syntax, <code>1</code> represents the intercept.) We also specify <code>family = binomial</code> to indicate we assume the response was drawn from a binomial distribution, which is correct in this case.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>library(lme4)
m &lt;- glmer(y ~ trt * sex + (1|id), data = d, family = binomial)
summary(m, corr = FALSE)

## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: y ~ trt * sex + (1 | id)
##    Data: d
## 
##      AIC      BIC   logLik deviance df.resid 
##   4132.4   4163.3  -2061.2   4122.4     3495 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.6008 -0.8434  0.3774  0.9704  1.6878 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 0.03944  0.1986  
## Number of obs: 3500, groups:  id, 250
## 
## Fixed effects:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -0.30840    0.07127  -4.327 1.51e-05 ***
## trttreat          2.18835    0.12423  17.615  &lt; 2e-16 ***
## sexmale          -0.63440    0.10859  -5.842 5.16e-09 ***
## trttreat:sexmale -1.21669    0.16556  -7.349 2.00e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

</pre>
</div>
<p>In the summary we see Random effects and Fixed effects. The fixed effect coefficients are not on the probability scale but on the log-odds, or <em>logit</em>, scale. The Logit transformation takes values ranging from 0 to 1 (probabilities) and transforms them to values ranging from <code>-Inf</code> to <code>+Inf</code>. This allows us to create additive linear models without worrying about going above 1 or below 0. To get probabilities out of our model, we need to use the <em>inverse logit</em>. There is function for this in base R called <code>plogis</code>. For example, the predicted log-odds a female in the control group eats vegetables is the intercept: -0.30840. The inverse logit of that is:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>plogis(-0.30840)
## [1] 0.4235053

</pre>
</div>
<p>The predicted probability of 0.42 is pretty close to the 0.40 value we used to generate the data.</p>
<p>The predicted log-odds a female in the treatment group eats vegetables is the intercept plus the coefficient for <code>trttreat</code>: -0.30840 + 2.18835 = 1.87995. The inverse logit is:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>plogis(1.87995)
## [1] 0.8676054

</pre>
</div>
<p>The predicted probability of 0.87 is close to the 0.85 value we used to generate the data.</p>
<p>The predicted log-odds a male in the control group eats vegetables is the intercept plus the coefficient for <code>sexmale</code>: -0.30840 + -0.63440 = -0.9428. The inverse logit is:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>plogis(-0.9428)
## [1] 0.2803351

</pre>
</div>
<p>The predicted probability of 0.28 is close to the 0.30 value we used to generate the data.</p>
<p>Finally the predicted log-odds a male in the treatment group eats vegetables is the sum of all the coefficients: -0.30840 + 2.18835 + -0.63440 + -1.21669 = 0.02886. The inverse logit is:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>plogis(0.02886)
## [1] 0.5072145

</pre>
</div>
<p>The predicted probability of 0.51 is very close to the 0.50 value we used to generate the data.</p>
<p>Instead of using <code>plogis</code>, we can simply use the <code>predict</code> function. The <code>re.form = NA</code> argument says to only estimate the fixed effects. The data frame given to the <code>newdata</code> argument represents all possible combinations of subject type.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>predict(m, type = "response", 
        re.form = NA,
        newdata = data.frame(sex = c("female", "female", 
                                     "male", "male"),
                             trt = c("control", "treat",
                                     "control", "treat"))
        )
##         1         2         3         4 
## 0.4235043 0.8676050 0.2803350 0.5072137

</pre>
</div>
<p>The predicted probabilities are the same as we calculated “by hand” above (minus some rounding error).</p>
<p>We could also interpret the model coefficients. To do this we exponentiate them to get an <em>odds ratio</em>. For example, exponentiating the treat coefficient yields 8.92.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>exp(2.18835)
## [1] 8.920482

</pre>
</div>
<p>That says the odds of “success” for a female in the treatment group is about 8.9 times higher than the odds of success for a female in the control group.</p>
<p>We could also exponentiate the confidence interval to get a lower and upper bound on the odds ratio:</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>exp(confint(m, parm = "trttreat"))
## Computing profile confidence intervals ...
##             2.5 %   97.5 %
## trttreat 7.023558 11.44831

</pre>
</div>
<p>So we might conclude the odds of “success” are at least 7 times higher for the female treated versus the female control.</p>
<p>But odds ratios are relative and can sometimes sound alarmist. For example, let’s say the effect of “treat” caused the probability of success to increase from 0.001 to 0.009. Neither probability is very likely, but the odds ratio is about 9.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>odds1 &lt;- 0.001/(1 - 0.001)
odds2 &lt;- 0.009/(1 - 0.009)
odds2/odds1
## [1] 9.072654

</pre>
</div>
<p>In this case describing the treatment effect as making the odds of success 9 times more likely may suggest to an unsuspecting reader that it’s more efficacious than it really is. That’s why it’s a good idea to examine expected probabilities in addition to odds ratios.</p>
<p>In the Random Effects section we see the estimated Standard Deviation of the Intercept random effect, which we can extract from the model object with the <code>VarCorr</code> function.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>VarCorr(m)
##  Groups Name        Std.Dev.
##  id     (Intercept) 0.1986

</pre>
</div>
<p>0.20 is the estimate of 0.03, the standard deviation we used to simulate our random probability effects. This seems to be a rather poor estimate. However if we calculate a 95% confidence interval on this estimate, we see that 0.03 falls well within the interval. To do this we call the <code>confint</code> function and specify <code>parm = "theta_"</code> to indicate we want a confidence interval for the estimated standard deviation of the intercept random effect. Setting <code>oldNames = FALSE</code> provides more informative output.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>confint(m, parm = "theta_", oldNames = FALSE)
##  Computing profile confidence intervals ...
##                    2.5 %    97.5 %
##  sd_(Intercept)|id     0 0.3453926

</pre>
</div>
<p>This confidence interval extends to 0, suggesting there may be no random variability between subjects. However we <em>know</em> we have variability because we generated the data. Plus the structure of the data dictates we should accommodate variance between subjects as well as within subjects. In other words, we don’t have independent observations. So in real life we wouldn’t seriously entertain dropping the random effect.</p>
<p>If we were to report this model using mathematical notation, we might write it in this form:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Prob&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mtext&gt;logit&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;0.31&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2.19&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mtext&gt;Treat&lt;/mtext&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;0.63&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mtext&gt;Male&lt;/mtext&gt;&lt;mo&gt;&amp;#x2013;&lt;/mo&gt;&lt;mn&gt;1.22&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mtext&gt;Treat&lt;/mtext&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mtext&gt;Male&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 44.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 37.336em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.114em, 1037.22em, 2.614em, -999.997em); top: -2.164em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mtext" id="MathJax-Span-3" style="font-family: MathJax_Main;">Prob</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-5"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.5em, 4.392em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.503em;"><span class="texatom" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.281em;">1</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="msubsup" id="MathJax-Span-14" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1001.89em, 4.392em, -999.997em); top: -3.997em; left: 0em;"><span class="mtext" id="MathJax-Span-15" style="font-family: MathJax_Main;">logit</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.442em; left: 1.947em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mo" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">0.31</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main; padding-left: 0.225em;">+</span><span class="mn" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.225em;">2.19</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.225em;">×</span><span class="mtext" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.225em;">Treat</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.169em;">0.63</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.225em;">×</span><span class="mtext" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.225em;">Male</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">–</span><span class="mn" id="MathJax-Span-32" style="font-family: MathJax_Main; padding-left: 0.169em;">1.22</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.225em;">×</span><span class="mtext" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.225em;">Treat</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.225em;">×</span><span class="mtext" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.225em;">Male</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.225em;">+</span><span class="msubsup" id="MathJax-Span-38" style="padding-left: 0.225em;"><span style="display: inline-block; position: relative; width: 0.947em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.56em, 4.169em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.558em;"><span class="mi" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.537em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Prob</mtext><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><msup><mtext>logit</mtext><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mo>−</mo><mn>0.31</mn><mo>+</mo><mn>2.19</mn><mo>×</mo><mtext>Treat</mtext><mo>–</mo><mn>0.63</mn><mo>×</mo><mtext>Male</mtext><mo>–</mo><mn>1.22</mn><mo>×</mo><mtext>Treat</mtext><mo>×</mo><mtext>Male</mtext><mo>+</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\text{Prob}(y_{j} = 1) =  \text{logit}^{-1}(-0.31 + 2.19 \times \text{Treat} – 0.63 \times \text{Male} – 1.22 \times \text{Treat} \times \text{Male} + u_j)</script></span></p>
<p>where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.392em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.336em, 1000.39em, 2.558em, -999.997em); top: -2.164em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">j</script></span> represents the subject id and</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mtext&gt;N&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0.20&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 7.892em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.558em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.225em, 1006.45em, 2.614em, -999.997em); top: -2.164em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="msubsup" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.947em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.56em, 4.169em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.558em;"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main; padding-left: 0.281em;">∼</span><span class="mtext" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.281em;">N</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-53" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.169em;">0.20</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.403em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>u</mi><mi>j</mi></msub><mo>∼</mo><mtext>N</mtext><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0.20</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">u_j \sim \text{N}(0, 0.20)</script></span></p>
<p>The <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 1.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.947em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.558em, 1000.95em, 2.614em, -999.997em); top: -2.164em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.947em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.56em, 4.169em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.558em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.397em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">u_j</script></span> is the random effect for each person. This says each subject’s random effect is assumed to be drawn from a Normal distribution with mean 0 and standard deviation 0.20.</p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mtext&gt;logit&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" style="width: 3.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.114em, 1002.95em, 2.558em, -999.997em); top: -2.164em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 2.947em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1001.89em, 4.392em, -999.997em); top: -3.997em; left: 0em;"><span class="mtext" id="MathJax-Span-65" style="font-family: MathJax_Main;">logit</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.442em; left: 1.947em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="mo" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.33em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mtext>logit</mtext><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">\text{logit}^{-1}</script></span> is the <em>inverse logit</em> function and it corresponds to the <code>plogis</code> function we used to transform log-odds into probability. In the language of generalized linear models, this is the <em>link</em> function. The logit is the link between an additive linear model and a probability outcome.</p>
<hr>
<p><strong>Side note:</strong> Previously we mentioned that we had generated our fake data incorrectly because we ran the risk of simulating probabilities outside the range of [0,1]. The correct way would have been to use the logit transformation as just described. However that means working with log-odds instead of probabilities, which are less intuitive. It’s not impossible to do, just inconvenient. Here’s how we could have simulated our response probabilities using log-odds and a logit transformation. <a href="https://rpubs.com/clayford/741841" rel="noopener noreferrer" target="_blank">See this page</a> for how we derived the log-odds.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>d$p2 &lt;- plogis(-0.4054651 + 
                 2.140066*(d$trt == "treat") +
                 -0.4418328*(d$sex == "male") +
                 -1.292768*(d$trt == "treat")*(d$sex == "male") +
                 rnorm(n = n, mean = 0, sd = 0.03)[d$id])
d$y2 &lt;- rbinom(n = nrow(d), size = 1, prob = d$p2)

</pre>
</div>
<hr>
<p>Returning to our estimated model, <code>m</code>, we can use it to simulate response data with the <code>simulate</code> function. If our model is “good”, it should simulate response data similar to what we observed. Here we use it to simulate 100 different data sets. It essentially takes our 3500 observed predictors, feeds them into the model, and generates a new series of ones and zeroes to indicate whether someone ate a vegetable or not. The result is a 100 column data frame which we save to an object called “sim”.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>sim &lt;- simulate(m, nsim = 100)

</pre>
</div>
<p>So what can we do with this data frame? One application is to use it to visualize how our estimated model performs compared to our observed data. We can look at our observed data by simply taking the mean of <code>y</code> by <code>trt</code> and <code>sex</code> using the <code>aggregate</code> function. (Recall the means of zeroes and ones is the proportion of ones.)</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>obs &lt;- aggregate(d$y, by = list(trt = d$trt, sex = d$sex), mean)
obs

##       trt    sex         x
## 1 control female 0.4242424
## 2   treat female 0.8659341
## 3 control   male 0.2820823
## 4   treat   male 0.5071429

</pre>
</div>
<p>Notice the observed probabilities are very close to our model predicted probabilities.</p>
<p>Now let’s do the same thing to all the columns in the “sim” data frame. We apply the <code>aggregate</code> function to each column, passing to <code>aggregate</code> the same arguments we used for the observed data. Then we combine the results into one data frame using the <code>do.call</code> and <code>rbind</code> functions.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>s_p &lt;- lapply(sim, aggregate,
              by = list(trt = d$trt,sex = d$sex),
              mean)
s_df &lt;- do.call(rbind, s_p)

</pre>
</div>
<p>Now we can plot the observed and simulated data to see how close the model-simulated data comes to the observed data. We use ggplot2 to create this plot. First we use <code>geom_point</code> to plot the “obs” data frame, making the observed proportions appear with a bigger blue point. Then we plot the simulated data in the “s_df” data frame using <code>geom_jitter</code>, which “jitters” the points sideways. The <code>alpha = 1/2</code> argument makes the points transparent and the <code>shape = 1</code> argument turns the points into open circles.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>library(ggplot2)
ggplot() +
  geom_point(aes(y = x, x = trt), data = obs, 
             size = 4, color = "blue") +
  geom_jitter(aes(y = x, x = trt), data = s_df, 
              width = 0.2, height = 0, shape = 1, alpha = 1/2) +
  facet_wrap(~sex) +
  labs(x = "Treatment", y = "Predicted Probability", 
       title = "Model with interaction")
	   
</pre>
</div>
<p><a href="https://data.library.virginia.edu/files/unnamed-chunk-23-1-1.png"><img src="./Binomial Generalized Linear Mixed Models_files/unnamed-chunk-23-1-1-1024x731.png" alt="" width="1024" height="731" class="aligncenter size-large wp-image-8953" srcset="https://data.library.virginia.edu/files/unnamed-chunk-23-1-1-1024x731.png 1024w, https://data.library.virginia.edu/files/unnamed-chunk-23-1-1-300x214.png 300w, https://data.library.virginia.edu/files/unnamed-chunk-23-1-1.png 1344w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>We can see our model-simulated data hovers very closely to the observed data, which is not surprising since we fit the “correct” model to the data.</p>
<p>Let’s fit a wrong model and recreate the plot. Below we fit a model without an interaction of “trt” and “sex”. This is not how we simulated the data so we know the model is wrong. After we fit the model we re-run the same code above to simulate responses from our model 100 times and plot with the observed data.</p>
<div style="padding-left: 40px;font-size: 80%">
<pre>m2 &lt;- glmer(y ~ trt + sex + (1|id), data = d, family = binomial)
sim2 &lt;- simulate(m2, nsim = 100)
s_p2 &lt;- lapply(sim2, aggregate,
              by = list(trt = d$trt, sex = d$sex),
              mean)
s_df2 &lt;- do.call(rbind, s_p2)
ggplot() +
  geom_point(aes(y = x, x = trt), data = obs, 
             size = 4, color = "blue") +
  geom_jitter(aes(y = x, x = trt), data = s_df2, 
              width = 0.2, height = 0, shape = 1, alpha = 1/2) +
  facet_wrap(~sex) +
  labs(x = "Treatment", y = "Predicted Probability", 
       title = "Wrong model: without interaction")
	   
</pre>
</div>
<p><a href="https://data.library.virginia.edu/files/unnamed-chunk-24-1-1.png"><img src="./Binomial Generalized Linear Mixed Models_files/unnamed-chunk-24-1-1-1024x731.png" alt="" width="1024" height="731" class="aligncenter size-large wp-image-8954" srcset="https://data.library.virginia.edu/files/unnamed-chunk-24-1-1-1024x731.png 1024w, https://data.library.virginia.edu/files/unnamed-chunk-24-1-1-300x214.png 300w, https://data.library.virginia.edu/files/unnamed-chunk-24-1-1.png 1344w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<p>Our model is systematically under-predicting and over-predicting probabilities of success. If our model was “good” we would expect it to generate data similar to what we observed.</p>
<p>Logistic regression and mixed-effect modeling are massive topics and we have just touched on the basics. But hopefully you now have a better idea of how the two can be combined to allow us to model the probability of binary events when we have clustered or repeated measures.</p>
<p>For questions or clarifications regarding this article, contact the UVA Library StatLab: <a href="mailto:statlab@virginia.edu">statlab@virginia.edu</a></p>
<p><a href="https://data.library.virginia.edu/category/statlab-articles/">View the entire collection</a> of UVA Library StatLab articles.</p>
<address>
<a href="https://data.library.virginia.edu/tag/clay-ford/">Clay Ford</a><br>
Statistical Research Consultant<br>
University of Virginia Library<br>
March 19, 2021<br>
</address>
      </div>
      <footer>

      </footer>
                </article>
                    </div>
      </div><!-- /#main -->
              <aside id="sidebar" class="threecol last" role="complementary" tabindex="-1">
              <div class="container">
          <div id="sidebar-area-top">
  </div>
<nav id="nav-utility" tabindex="-1">
  <div class="menu-research-data-services-container"><ul id="menu-research-data-services" class="menu"><li id="menu-item-4131" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4131"><a href="https://data.library.virginia.edu/training/">Workshops</a></li>
<li id="menu-item-1599" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1599"><a href="https://data.library.virginia.edu/datasources/">Data Discovery</a>
<ul class="sub-menu">
	<li id="menu-item-1601" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1601"><a href="https://data.library.virginia.edu/datasources/licensed/">Licensed Data Sources</a></li>
	<li id="menu-item-2480" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2480"><a href="http://guides.lib.virginia.edu/data">Research Guide</a></li>
</ul>
</li>
<li id="menu-item-1602" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1602"><a href="https://data.library.virginia.edu/data-management/">Research Data Management</a>
<ul class="sub-menu">
	<li id="menu-item-1603" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1603"><a href="https://data.library.virginia.edu/data-management/dmp-support/">Data Management Planning Support</a></li>
	<li id="menu-item-1604" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1604"><a href="https://data.library.virginia.edu/?page_id=1286">What is Data Management?</a></li>
	<li id="menu-item-1605" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1605"><a href="https://data.library.virginia.edu/data-management/plan/">Data Management Components</a></li>
	<li id="menu-item-1654" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1654"><a href="https://data.library.virginia.edu/data-management/fall2014/">Past Data Management Workshops</a></li>
</ul>
</li>
<li id="menu-item-1641" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1641"><a href="https://data.library.virginia.edu/statlab/">StatLab</a>
<ul class="sub-menu">
	<li id="menu-item-3259" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-3259"><a href="https://data.library.virginia.edu/category/statlab-articles/">StatLab Articles</a></li>
</ul>
</li>
<li id="menu-item-1620" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1620"><a href="https://data.library.virginia.edu/research-software/">Research Software</a>
<ul class="sub-menu">
	<li id="menu-item-1621" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1621"><a href="https://data.library.virginia.edu/research-software/amos/">AMOS</a></li>
	<li id="menu-item-1622" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1622"><a href="https://data.library.virginia.edu/research-software/ansys/">ANSYS</a></li>
	<li id="menu-item-1623" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1623"><a href="https://data.library.virginia.edu/research-software/arcinfo-by-esri/">GIS Software</a></li>
	<li id="menu-item-1624" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1624"><a href="https://data.library.virginia.edu/research-software/idl/">IDL</a></li>
	<li id="menu-item-1625" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1625"><a href="https://data.library.virginia.edu/research-software/labview/">LabVIEW</a></li>
	<li id="menu-item-1627" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1627"><a href="https://data.library.virginia.edu/research-software/mathematica/">Mathematica for Staff and Faculty</a></li>
	<li id="menu-item-1629" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1629"><a href="https://data.library.virginia.edu/research-software/minitab-2/">Minitab</a></li>
	<li id="menu-item-1631" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1631"><a href="https://data.library.virginia.edu/research-software/originpro/">OriginPro</a></li>
	<li id="menu-item-1632" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1632"><a href="https://data.library.virginia.edu/research-software/other-software/">Other Software</a></li>
	<li id="menu-item-1633" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1633"><a href="https://data.library.virginia.edu/research-software/oxygen/">oXygen</a></li>
	<li id="menu-item-1635" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1635"><a href="https://data.library.virginia.edu/research-software/sas/">SAS</a></li>
	<li id="menu-item-1638" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1638"><a href="https://data.library.virginia.edu/research-software/spss/">SPSS</a></li>
	<li id="menu-item-1639" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1639"><a href="https://data.library.virginia.edu/research-software/stata/">Stata</a></li>
</ul>
</li>
<li id="menu-item-4661" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4661"><a href="https://data.library.virginia.edu/sne/">Social, Natural, Engineering Sciences</a></li>
<li id="menu-item-1617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1617"><a href="https://data.library.virginia.edu/rds-staff/">Meet the Team</a></li>
</ul></div></nav>
<div id="sidebar-area-bottom">
  </div>
        </div>
            </aside><!-- /#sidebar -->
        </div><!-- /#content -->
    </div></div><!-- /.row /.container -->
<div class="container footer-container"><div class="row row-container clearfix">
    <footer id="content-info" class="row" role="contentinfo">
            <div class="container">
                <p id="copyright">© 2023 by the Rector and Visitors of the <a href="http://www.virginia.edu/">University of Virginia</a></p>
      </div>
    </footer>
    </div></div><!-- /.row /.container -->
  </div><!-- /#wrap -->


<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://analytics.lib.virginia.edu/" : "http://analytics.lib.virginia.edu/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Binomial Generalized Linear Mixed Models_files/piwik.js.download" type="text/javascript"></script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 17);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="https://analytics.lib.virginia.edu/piwik.php?idsite=17" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->





<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/skipToInit.js.download"></script>
<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/SkipTo.min.js.download"></script>
<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/wp-embed.min.js.download"></script>


<script src="./Binomial Generalized Linear Mixed Models_files/css3-mediaqueries.js.download"></script>

<!-- include Cycle plugin -->
<script type="text/javascript" src="./Binomial Generalized Linear Mixed Models_files/jquery.cycle.all.js.download"></script>
<script src="./Binomial Generalized Linear Mixed Models_files/plugins.js.download"></script>


  <!--[if lt IE 7]>
    <script defer src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script defer>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->


<script src="./Binomial Generalized Linear Mixed Models_files/script.js.download"></script>
<script src="./Binomial Generalized Linear Mixed Models_files/gravity_scripts.js.download"></script>
<script src="./Binomial Generalized Linear Mixed Models_files/bootstrap.min.js.download"></script>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Math-italic, sans-serif;"></div></div></body><div id="vimeo-record-extension"></div></html>